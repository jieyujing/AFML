# API Reference: feature_clusters.py

**Language**: Python

**Source**: `clustering/feature_clusters.py`

---

## Functions

### get_feature_clusters(X: pd.DataFrame, dependence_metric: str, distance_metric: str = None, linkage_method: str = None, n_clusters: int = None, critical_threshold: float = 0.0) → list

Machine Learning for Asset Managers
Snippet 6.5.2.1 , page 85. Step 1: Features Clustering

Gets clustered features subsets from the given set of features.

:param X: (pd.DataFrame) Dataframe of features.
:param dependence_metric: (str) Method to be use for generating dependence_matrix, either 'linear' or
                          'information_variation' or 'mutual_information' or 'distance_correlation'.
:param distance_metric: (str) The distance operator to be used for generating the distance matrix. The methods that
                        can be applied are: 'angular', 'squared_angular', 'absolute_angular'. Set it to None if the
                        feature are to be generated as it is by the ONC algorithm.
:param linkage_method: (str) Method of linkage to be used for clustering. Methods include: 'single', 'ward',
                       'complete', 'average', 'weighted', and 'centroid'. Set it to None if the feature are to
                       be generated as it is by the ONC algorithm.
:param n_clusters: (int) Number of clusters to form. Must be less the total number of features. If None then it
                   returns optimal number of clusters decided by the ONC Algorithm.
:param critical_threshold: (float) Threshold for determining low silhouette score in the dataset. It can any real number
                            in [-1,+1], default is 0 which means any feature that has a silhouette score below 0 will be
                            indentified as having low silhouette and hence requied transformation will be appiled to for
                            for correction of the same.
:return: (list) Feature subsets.

**Parameters**:

| Name | Type | Default | Description |
|------|------|---------|-------------|
| X | pd.DataFrame | - | - |
| dependence_metric | str | - | - |
| distance_metric | str | None | - |
| linkage_method | str | None | - |
| n_clusters | int | None | - |
| critical_threshold | float | 0.0 | - |

**Returns**: `list`



### _cluster_transformation(X: pd.DataFrame, clusters: dict, feats_to_transform: list) → pd.DataFrame

Machine Learning for Asset Managers
Snippet 6.5.2.1 , page 85. Step 1: Features Clustering (last paragraph)

Transforms a dataset to reduce the multicollinearity of the system by replacing the original feature with
the residual from regression.

:param X: (pd.DataFrame) Dataframe of features.
:param clusters: (dict) Clusters generated by ONC algorithm.
:param feats_to_transform: (list) Features that have low silhouette score and to be transformed.
:return: (pd.DataFrame) Transformed features.

**Parameters**:

| Name | Type | Default | Description |
|------|------|---------|-------------|
| X | pd.DataFrame | - | - |
| clusters | dict | - | - |
| feats_to_transform | list | - | - |

**Returns**: `pd.DataFrame`



### _combine_features(X, clusters, exclude_key) → np.array

Combines features of each cluster linearly by following a minimum variance weighting scheme.
The Minimum Variance weights are calculated without constraints, other than the weights sum to one.

:param X: (pd.DataFrame) Dataframe of features.
:param clusters: (dict) Clusters generated by ONC algorithm.
:param exclude_key: (int) Key of the cluster which is to be excluded.
:return: (np.array) Combined features for each cluster.

**Parameters**:

| Name | Type | Default | Description |
|------|------|---------|-------------|
| X | None | - | - |
| clusters | None | - | - |
| exclude_key | None | - | - |

**Returns**: `np.array`



### _check_for_low_silhouette_scores(X: pd.DataFrame, critical_threshold: float = 0.0) → pd.DataFrame

Machine Learning for Asset Managers
Snippet 6.5.2.1 , page 85. Step 1: Features Clustering (last paragraph)

Checks where the dataset contains features low silhouette due one feature being a combination of
multiple features across clusters. This is a problem, because ONC cannot assign one feature to multiple
clusters and it needs a transformation.

:param X: (pd.DataFrame) Dataframe of features.
:param critical_threshold: (float) Threshold for determining low silhouette score.
:return: (pd.DataFrame) Dataframe of features.

**Parameters**:

| Name | Type | Default | Description |
|------|------|---------|-------------|
| X | pd.DataFrame | - | - |
| critical_threshold | float | 0.0 | - |

**Returns**: `pd.DataFrame`


